define(function(d,a,e){var f=d("mz"),c=null,b=navigator.userAgent,g={versions:function(){return{trident:b.indexOf("Trident")>-1,presto:b.indexOf("Presto")>-1,webKit:b.indexOf("AppleWebKit")>-1,gecko:b.indexOf("Gecko")>-1&&b.indexOf("KHTML")==-1,mobile:!!b.match(/AppleWebKit.*Mobile.*/)||!!b.match(/Mobile/),ios:b.indexOf("ios")>-1,android:b.indexOf("Android")>-1,linux:b.indexOf("Linux")>-1,iPhone:b.indexOf("iPhone")>-1,mac:b.indexOf("Mac")>-1,iPad:b.indexOf("iPad")>-1,safari:b.indexOf("Safari")>-1,maxthon:b.indexOf("Maxthon")>-1,isIE:b.indexOf("MSIE")>-1,isIE6:b.indexOf("MSIE 6.0")>-1,isIE7:b.indexOf("MSIE 7.0")>-1};
}()};return function(h){(function(v,N,K,ag){var A=function(){},m={mainObjects:[],loadedObjects:[]},S=0,u=0,Y=-1,L="<div id='demilamedia_mask'></div>",W="<div id='demilamedia_tit'></div>",Z="<div id='demilamedia_tips'></div>",ad="<div id='demilamedia'>		<div class='demilamedia_top'><div class='hlb_left'></div><div class='hlb_middle'></div><div class='hlb_right'></div></div>		<div id='demilamedia_objs'><div class='objleftbg'><div class='objrightbg'><div id='demilamedia_main'></div></div></div><span id='demilamedia_loading'></span></div>		<div id='demilamedia_arrbtn'><a id='demilamedia_leftbtn' title='上一张'></a><a id='demilamedia_rightbtn' title='下一张'></a><div id='demilamedia_pagenum'></div></div>		<a id='demilamedia_closebtn' title='关闭'>关闭</a>		<div class='demilamedia_bottom'><div class='hlb_left'></div><div class='hlb_middle'></div><div class='hlb_right'></div></div>		</div>",ah={soundW:650,soundH:80,videoW:650,videoH:330,defW:120,defH:100,minImgW:200,minImgH:200,maxW:K(v).width(),maxH:K(v).height(),maxImgW:K(v).width()-100,maxImgH:K(v).height()-120,tips:"按ESC键返回 按方向键切换"},X=null,O=null,C=null,r=null,ae=null,q=null,k=null,T=null,U=null,M=null,H={img:/^jpg|png|gif$/i,video:/^swf|mp4|flv|wmv$/i,sound:/^wma|wav|mp3$/i},y=/^mp4$/i,p=/^mp3|ogg|wav$/i,B={need:false,statue:""};
A.open=function(aj){J(aj);X.show();O.show();j();Q(ah.defW,ah.defH,function(){A.currentObj(0);},true);if(aj.length<=1){r.children().hide();}else{var ai=K._data($hxlb_lbtn[0],"events");
if(!(ai&&ai.click)){$hxlb_lbtn.on("click",function(){if(K(this).hasClass("disable")){return;}A.prevObj();});}ai=K._data($hxlb_rbtn[0],"events");if(!(ai&&ai.click)){$hxlb_rbtn.on("click",function(){if(K(this).hasClass("disable")){return;
}A.nextObj();});}}return false;};A.init=function(ai){K.extend(ah,ai);K("body").append(K(ad)).append(K(L)).append(K(W)).append(K(Z));X=K("#demilamedia_mask");
O=K("#demilamedia");C=O.find("#demilamedia_objs");r=O.find("#demilamedia_arrbtn");$hxlb_lbtn=r.find("#demilamedia_leftbtn");$hxlb_rbtn=r.find("#demilamedia_rightbtn");
ae=O.find("#demilamedia_closebtn");k=O.find("#demilamedia_main");q=O.find("#demilamedia_loading");T=K("#demilamedia_tit");U=K("#demilamedia_tips");M=O.find("#demilamedia_pagenum");
aa();K(v).on("resize",aa).on("keyup",function(aj){switch(aj.keyCode){case 37:A.prevObj();break;case 39:A.nextObj();break;case 27:A.close();break;}});ae.on("click",function(){A.close();
});X.on("click",function(){A.close();});U.html(ah.tips);i();};A.prevObj=function(){Y--;if(Y<0){Y++;}else{A.currentObj(Y);}};A.nextObj=function(){Y++;if(Y>S-1){Y--;
}else{A.currentObj(Y);}};A.close=function(){k.html("");r.children().hide();w();Y=0;Q(0,0,function(){O.hide();X.hide();t();},true);};A.currentObj=function(ai){j();
w();if(m.loadedObjects[ai]){var ak=m.loadedObjects[ai];if(D(ak)){ak=I(ak);Q(ak.width,ak.height,function(){k.html(n(ak));i();z();});}else{if(ab(ak)){Q(ah.soundW,ah.soundH,function(){var am=V(ak);
if(am.flash){k.html(am.html);l("demilamedia_flash","/static/scripts/plug/demilamedia/videoplayer/",ah.soundW,ah.soundH,{playlist:ak});}else{k.html(am);
}i();z();});}else{if(E(ak)){Q(ah.videoW,ah.videoH,function(){var am=ac(ak);if(am.flash){k.html(am.html);l("demilamedia_flash","/static/scripts/plug/demilamedia/videoplayer/",ah.videoW,ah.videoH,{playlist:ak});
}else{k.html(am);}i();z();});}}}}else{var al=m.mainObjects[ai].href;if(D(al)){var aj=new Image();aj.src=al;m.loadedObjects[ai]=aj;aj.onload=function(){aj=I(aj);
Q(aj.width,aj.height,function(){k.html(n(aj));i();z();});};aj.onabort=function(){m.loadedObjects.splice(ai,1);};}else{if(ab(al)){m.loadedObjects[ai]=al;
Q(ah.soundW,ah.soundH,function(){var am=V(al);if(am.flash){k.html(am.html);l("demilamedia_flash","/static/scripts/plug/demilamedia/videoplayer/",ah.soundW,ah.soundH,{playlist:al});
}else{k.html(am);}i();z();});}else{if(E(al)){m.loadedObjects[ai]=al;Q(ah.videoW,ah.videoH,function(){var am=ac(al);if(am.flash){k.html(am.html);l("demilamedia_flash","/static/scripts/plug/demilamedia/videoplayer/",ah.videoW,ah.videoH,{playlist:al});
}else{k.html(am);}i();z();});}}}}T.html(m.mainObjects[ai].title);Y=ai;if(Y==0){$hxlb_lbtn.addClass("disable");}else{$hxlb_lbtn.removeClass("disable");}if(Y==S-1){$hxlb_rbtn.addClass("disable");
}else{$hxlb_rbtn.removeClass("disable");}};K.fn.demilamedia=function(ai){console.log("building...");};K.fn.demilamedia.open=function(ai){console.log("building...");
};K.extend({demilamedia:A});A.init();function I(ai){if(ai.width<ah.minImgW){ai.height=parseInt(ai.height*ah.minImgW/ai.width);ai.width=ah.minImgW;return ai;
}if(ai.height<ah.minImgH){ai.width=parseInt(ai.width*ah.minImgH/ai.height);ai.height=ah.minImgH;return ai;}if(ai.width>ah.maxImgW){ai.height=parseInt(ai.height*ah.maxImgW/ai.width);
ai.width=ah.maxImgW;console.log(ai.width+", "+ai.height);}if(ai.height>ah.maxImgH){ai.width=parseInt(ai.width*ah.maxImgH/ai.height);ai.height=ah.maxImgH;
return ai;}return ai;}function z(){M.html((Y+1)+"/"+S);}function Q(ai,ak,al,aj){r.children().hide();O.animate({"margin-left":-1*(ai+40)/2,"margin-top":-1*(ak+60)/2});
k.animate({width:ai,height:ak},function(){if(al){al();}if(!aj){r.children().show();o();}});}function J(ai){if(F(ai)){S=ai.length;u=0;m.mainObjects=ai;}}function w(){T.hide();
U.hide();}function o(){T.slideDown();U.show();}function i(){T.css("top",(ah.maxH-k.height()-60)/2-20-3);U.css("top",(ah.maxH+k.height()+60)/2+1);}function n(ai){return"<img src='"+ai.src+"' width='"+ai.width+"' height='"+ai.height+"' />";
}function V(aj){var ai="";if(g.versions.mobile||g.versions.iPad){if(p.test(x(aj))){ai="<audio id='demilamedia_sound' controls='controls' autoplay='autoplay'>					<source src='"+aj+"' type='audio/"+x(aj)+"' />					<embed src='"+aj+"' />					</audio>";
}return ai;}else{if(f.audio){ai="<audio id='demilamedia_sound' controls='controls' autoplay='autoplay'>				<source src='"+aj+"' type='audio/"+x(aj)+"' />				<embed src='"+aj+"' />				</audio>";
return ai;}else{ai=G();return{flash:true,html:ai};}}}function ac(aj){var ai="";if(g.versions.mobile||g.versions.iPad){if(y.test(x(aj))){ai="<video id='demilamedia_video' controls='controls' autoplay='autoplay'>					<source src='"+aj+"' type='video/"+x(aj)+"' />					</video>";
}return ai;}else{if(f.video){ai="<video id='demilamedia_video' controls='controls' autoplay='autoplay'>					<source src='"+aj+"' type='video/"+x(aj)+"' />					</video>";
return ai;}else{ai=G();return{flash:true,html:ai};}}}function G(){return"<div id='demilamedia_flash'></div>";}function P(){return"<span class='loading'></span>";
}function t(){k.html("");}function j(){k.html(P());}function aa(){var ai=K(v).width(),aj=K(v).height();ah.maxW=ai;ah.maxH=aj;if(ah.videoW>ai-10){ah.videoW=ai-10;
}if(ah.videoH>aj-120){ah.videoH=aj-120;}if(ah.soundW>ai-10){ah.soundW=ai-10;}if(ah.soundH>aj-120){ah.soundH=aj-120;}i();}function E(ai){if(s(ai)){return H.video.test(x(ai));
}return false;}function ab(ai){if(s(ai)){return H.sound.test(x(ai));}return false;}function D(ai){if(R(ai)){return ai.tagName.toLowerCase()==="img";}else{if(s(ai)){return H.img.test(x(ai));
}}return null;}function F(ai){return Object.prototype.toString.call(ai)==="[object Array]";}function R(ai){return typeof ai==="object";}function s(ai){return typeof ai==="string";
}function af(ai){return typeof ai==="number";}function x(ak){var ai=/\.[^\.]+$/.exec(ak.toLowerCase());if(!ai||ai.length==0){return null;}var aj=ai[0];
aj=aj.replace(".","");return aj;}function l(aj,ap,am,ai,ar){var an=document.getElementById(aj),at=an.id,al="/static/scripts/plug/demilamedia/videoplayer/player.swf",ak="opaque";
if(g.versions.isIE){an.innerHTML='\x3cobject classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"100%" height\x3d"100%" id\x3d"'+at+'" name\x3d"'+at+'" tabindex\x3d"0"\x3e\x3cparam name\x3d"movie" value\x3d"'+al+'"\x3e\x3cparam name\x3d"allowfullscreen" value\x3d"true"\x3e\x3cparam name\x3d"allowscriptaccess" value\x3d"always"\x3e\x3cparam name\x3d"seamlesstabbing" value\x3d"true"\x3e\x3cparam name\x3d"wmode" value\x3d"'+ak+'"\x3e\x3cparam name\x3d"bgcolor" value\x3d"#000000"\x3e\x3cparam name\x3d"autostart" value\x3d"true"\x3e\x3cparam name\x3d"flashvars" value\x3d"file='+ar.playlist+'"\x3e\x3c/object\x3e';
}else{var ao=document.createElement("object");ao.setAttribute("type","application/x-shockwave-flash");ao.setAttribute("data",al);ao.setAttribute("width","100%");
ao.setAttribute("height","100%");ao.setAttribute("bgcolor","#000000");ao.setAttribute("id",at);ao.setAttribute("name",at);ao.setAttribute("flashvars","file="+ar.playlist);
ao.className="jwswf";aq(ao,"file",ar.playlist);aq(ao,"allowfullscreen","true");aq(ao,"allowscriptaccess","always");aq(ao,"seamlesstabbing","true");aq(ao,"autostart","true");
aq(ao,"wmode",ak);an.parentNode.replaceChild(ao,an);}function aq(av,au,ax){var aw=document.createElement("param");aw.setAttribute("name",au);aw.setAttribute("value",ax);
av.appendChild(aw);}}})(window,document,h);};});